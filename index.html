<!DOCTYPE html>
<html lang="en">

<head>
    <script>

// Names of the two caches used in this version of the service worker.
// Change version when you update any of the local resources, which will
// in turn trigger the install event again.
const PRECACHE = 'precache-v1.0.0.0';
const RUNTIME = 'runtime';

// A list of local resources we always want to be cached.
const PRECACHE_URLS = [
  'index.html',
  './', // Alias for index.html
  'styles.css',
  '../../styles/main.css',
  'demo.js'
];

// The install handler takes care of precaching the resources we always need.
self.addEventListener('install', event => {
  event.waitUntil(
    caches.open(PRECACHE)
      .then(cache => cache.addAll(PRECACHE_URLS))
      .then(self.skipWaiting())
  );
});

// The activate handler takes care of cleaning up old caches.
self.addEventListener('activate', event => {
  const currentCaches = [PRECACHE, RUNTIME];
  event.waitUntil(
    caches.keys().then(cacheNames => {
      return cacheNames.filter(cacheName => !currentCaches.includes(cacheName));
    }).then(cachesToDelete => {
      return Promise.all(cachesToDelete.map(cacheToDelete => {
        return caches.delete(cacheToDelete);
      }));
    }).then(() => self.clients.claim())
  );
});

// The fetch handler serves responses for same-origin resources from a cache.
// If no response is found, it populates the runtime cache with the response
// from the network before returning it to the page.
self.addEventListener('fetch', event => {
  // Skip cross-origin requests, like those for Google Analytics.
  if (event.request.url.startsWith(self.location.origin)) {
    event.respondWith(
      caches.match(event.request).then(cachedResponse => {
        if (cachedResponse) {
          return cachedResponse;
        }

        return caches.open(RUNTIME).then(cache => {
          return fetch(event.request).then(response => {
            // Put a copy of the response in the runtime cache.
            return cache.put(event.request, response.clone()).then(() => {
              return response;
            });
          });
        });
      })
    );
  }
});
    </script>
    <title>Probe Tracker</title>
    <meta charset="utf-8">
    <meta name="description"
        content="Simple Star Wars Rebellion board game probe tracker. Hosted on github to tick off each system as the Empire player.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimal-ui">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300italic,700,700italic">

    <!-- CSS Reset -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">

    <!-- Milligram CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css">

    <!-- Personal stylesheet-->
    <link rel="stylesheet" href="stylesheet.css">

    <!-- Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">
</head>

<body>
    <main class="wrapper">
        <nav class="navigation">
            <section class="container">
                <a class="navigation-title" href="#">Probe Tracker</a>
                <ul class="navigation-list float-right">
                    <li class="navigation-item navigation-link float-right" href="#" onclick="refreshSystems()" data-popover="">Reset
                        Systems</li>
                    <li class="navigation-item navigation-link float-right" href="#" onclick="undo()" data-popover="">Undo</li>
                    <!--<li class="navigation-item float-right">
                            <a class="navigation-link" href="#" onclick="refreshSystems()" data-popover="">ResetSystems</a>
                        </li>
                        <li class="navigation-item float-right">
                            <a class="navigation-link" href="#" onclick="undo()" data-popover="">Undo</a>
                        </li>-->
                </ul>
            </section>
        </nav>
        <section class="container">
            <dl id="SystemList">
                <script>
                    // Finds the target to add list items
                    var target = document.getElementById("SystemList");
                    // Generates the full list of systems as a list of strings
                    const fullList = ["Alderaan", "Bespin", "Bothawui", "Cato Neimoidia", "Corellia", "Dagobah", "Dantooine", "Dathomir", "Endor", "Feluica", "Geonosis", "Hoth", "Ilum", "Kashyyk", "Kessel", "Malastare", "Mandalore", "Mon Calamari", "Mustafar", "Mygeeto", "Naboo", "Nal Hutta", "Ord Mantell", "Rodia", "Ryloth", "Saleucami", "Sullust", "Tatooine", "Toydaria", "Utapau", "Yavin"];
                    var shownListItems = [];
                    var probeHistory = [];
                    refreshSystems(true);

                    function refreshSystems(fullRefresh = true) {
                        target.innerHTML = "";
                        if (fullRefresh) {
                            shownListItems = [];
                            probeHistory = [];
                            for (var i = 0; i < fullList.length; i++)
                                shownListItems.push(true);
                        }
                        for (var i = 0; i < fullList.length; i++)
                            if (shownListItems[i])
                                target.innerHTML += '<dt id="' + i + '"><p class="float-left">' + fullList[i] + '</p><button class="button float-right" onclick="removeSystem(' + i + ')">Probe System</button><br><hr></dt>';
                    }

                    function undo() {
                        if (probeHistory.length == 0) return;
                        var i = probeHistory[probeHistory.length - 1];
                        probeHistory.pop();
                        shownListItems[i] = true;
                        refreshSystems(false);//Don't do a full refresh
                    }

                    function removeSystem(systemI) {
                        shownListItems[systemI] = false;//Sets this to false to stop it from being displayed
                        probeHistory.push(systemI);//Adds the removed systems to history.
                        refreshSystems(false);
                    }
                </script>
            </dl>
        </section>
    </main>
</body>

</html>